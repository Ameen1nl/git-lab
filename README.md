Example Python project
======================

This is an example of a Python Project. Use this
as a starting point for creating new python projects.

There are multiple different kinds of Python projects possible.
This project is not an app. 
This project is not a library. 
This project is not a data science project.

This project does cover some basics that could fit in all of the previously managed
different types of python projects. 
This project features examples of:

- structuring a python module
  - readme and changelog (`README.md`, `CHANGELOG.md`)
  - package namespacing (e.g. `ff`)
- testing with `pytest`
  - unittests
  - test coverage
  - fixtures
  - property-based tests (with `hypothesis`)
- running multiple checks with `tox`
  - code style
  - compatibility with multiple python versions
  - type checking
- (partially) autogenerated documentation with `sphinx`
- Setting up a build on github actions
- ...

Installation
------------

**TODO**

For now I don't think a project that is started from this template will have a clear installation instruction. 
Perhaps it will have clear "starting development" instructions instead.


Usage
-----

To use this repository as a template, perform the following steps:

- copy the relevant files

  ```bash
  cd ff.examplelib
  cp -r {README.md,CHANGELOG.md,mypy.ini,poetry.toml,pyproject.toml,poetry.lock,tox.ini,docs,src,tests,.gitignore,Makefile,bamboo-specs} path/to/new/repo/
  ```
- change the description in the README.
- change the package metadata in `pyproject.toml`. Reset the version.
- change the package name. Change this in all copied files!
  Do a text search (e.g. `grep`) to check you've found all references.
- remove any unneeded dependencies in `pyproject.toml` (e.g. `numpy`)
  
Development guide
-----------------

### Requirements

- Supported Python versions (see `pyproject.toml` )installed.
  See [HERE](./docs/pyenv.md).
- The poetry dependency manager. Install as described [HERE](./docs/poetry.md)

### Setup

First create a virtual environment:

On Mac:
```bash
pyenv virtualenv 3.9.8 exampleproj_3_9_8
```

On Windows:
```powershell
pyenv local 3.9.8
python -m venv .venv
.\.venv\Scripts\activate
```

To install all development requirements, run:

```bash
# running this in a virtualenv is highly recommended
poetry install
```

### make/run script?
**TODO** write some explanation on the make/run script.

### Checks

To run all checks (tests, linting, docs, etc), run:

```bash
tox
```

Use the `--parallel auto` option to run in parallel. If you run into
issues, try using the `--recreate` option to recreate the environments.

### Tests

To run the tests, use the following command:

```bash
pytest
```

To analyze test coverage, use:

```bash
make pytest
```

### Type checking

```bash
make type-check
```

### Style and formatting

`black` can be used to automatically format code, so you don\'t have to
worry about the nitty-gritty of code style.

```bash
make format-check
```

Use `isort` to automatically sort imports.

```bash
make isort-check
```

`flake8` checks some additional things that can't be fixed automatically
with `black`. Run this command to list any issues:

```bash
make lint
```

To fix `black` and `isort` issues automatically, run:

```bash
make fix
```

### Documentation

To generate documentation with `sphinx`, run the following command:

```bash
make documentation
```

This command will output a local URI which you can open in your browser.

### Contributing

To contribute, create a pull request.
Before merging, all checks must pass successfully (i.e. the `tox` command).

Please update the `CHANGLELOG.md` and the version in `pyproject.toml` accordingly.

### Publishing

Commits on the `main` branch are automatically published
if the `version` in `pyproject.toml` has not yet been tagged.
Do *not* create `v{X.X.X}` tags manually.
After publishing to KL nexus, a tag is automatically created.
These steps can be seen in the build log.
